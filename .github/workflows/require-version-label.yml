name: Require Version Label

on:
  pull_request:
    types: [opened, labeled, unlabeled, synchronize]
    branches: [main]

jobs:
  check-label:
    runs-on: ubuntu-latest
    steps:
      - name: Check for version label
        run: |
          LABELS='${{ toJSON(github.event.pull_request.labels.*.name) }}'
          
          if echo "$LABELS" | grep -qE '"version:(patch|minor|major|skip)"'; then
            echo "✅ Version label found"
          else
            echo "❌ Missing version label"
            echo ""
            echo "Please add one of these labels:"
            echo "  • version:patch - Bug fixes, small changes (1.0.x)"
            echo "  • version:minor - New features (1.x.0)"
            echo "  • version:major - Breaking changes (x.0.0)"
            echo "  • version:skip  - No release needed (docs, CI, etc.)"
            exit 1
          fi
